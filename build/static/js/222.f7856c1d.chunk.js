"use strict";(self.webpackChunkctlotus_valuation=self.webpackChunkctlotus_valuation||[]).push([[222],{22222:function(e,t,n){n.r(t),n.d(t,{MembershipCard:function(){return oe}});var i=n(29439),o=n(19860),l=n(10437),r=n(61113),s=n(35898),a=n(48310),d=n(45624),c=n(25645),h=n(27314),x=n(47313),u=n(24511),p=n(97890),m=n(31538),g=n(26002),f=n(75184),Z=n(65165),b=n(74165),j=n(15861),v=n(1413),y=n(47131),C=n(19536),w=n(70501),k=n(63501),S=n(64351),R=n(2220),D=n(33222),T=n(52387),I=n(95688),E=n(1983),M=n(7193),F=n(35931);var A=n.p+"static/media/ic-qrcode.f3aad342a5534d729757084ff6274482.svg",W=n(10658),L=n.n(W),z=n(81404),N=n.n(z),P=n(78925),q=n(43270),O=n(68161),_=n(94469),B=n(9019),G=n(41979),H=n(46417);function Y(e){var t=e.isOpen,n=e.handleClose,i=e.handleSubmit,o=e.handleCancel,r=e.children,s=e.actionName,a=(e.actionCancel,e.buttonMode,e.hideCancelButton),d=(e.isIcon,(0,u.$)().t);return(0,H.jsx)(_.Z,{open:t,onClose:n,children:(0,H.jsxs)(B.ZP,{sx:{height:"max-content",padding:"25px 45px 25px 45px",minWidth:{md:"596px"},alignItems:"center",display:"flex",flexDirection:"column"},children:[(0,H.jsx)("img",{src:G.Z,alt:"delete-icon",className:"cursor-pointer absolute top-4 right-4",onClick:n,height:20,width:20}),r,(0,H.jsxs)(l.Z,{mt:4,children:[!a&&(0,H.jsx)(c.Z,{title:"D\xf3ng",variant:"outlined",handleClick:o||n,sxProps:{borderRadius:"8px",width:{md:"126px"}}}),(0,H.jsx)(c.Z,{title:s||d(h.I.common.save),sxProps:{borderRadius:"8px",width:{md:"126px"},ml:"12px"},handleClick:i,light:!0})]})]})})}var V=n(7791),Q=n(83294);function U(e){var t=(0,o.Z)(),n=(0,u.$)().t,i=e.isFilter,s=e.submitFilter,a=e.filterList;return(0,H.jsxs)(l.Z,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},color:t.palette.secondary.contrastText,bgcolor:m.Z.primary.barList,borderRadius:"8px",mb:"15px",p:"20px 20px 8px 20px"},children:[(0,H.jsx)(l.Z,{sx:{display:"flex",gap:{xs:"12px",sm:"0px"},alignItems:"center"},children:null===a||void 0===a?void 0:a.map((function(e){return(0,H.jsx)(x.Fragment,{children:"date"!==e.type&&(0,H.jsx)(Q.Z,{label:e.label,list:e.options,handleSelected:e.handleSelected})},e.label)}))}),(0,H.jsxs)(l.Z,{sx:{display:"flex",gap:{xs:"12px",sm:"0px"},alignItems:"center"},children:[null===a||void 0===a?void 0:a.map((function(e){return(0,H.jsx)(x.Fragment,{children:"date"===e.type&&(0,H.jsx)(V.Z,{onChange:e.onChange,placeholder:null===e||void 0===e?void 0:e.placeholder,sx:{width:"213px"}})},e.label)})),(0,H.jsx)(r.Z,{sx:{fontSize:14,fontWeight:500,color:"#222222",background:t.palette.common.white,p:"0px 8px 0px 8px",mb:"47px",ml:"12px",position:"absolute"},children:"Th\u1eddi gian"})]}),i&&(0,H.jsx)(c.Z,{title:n(h.I.common.search),buttonMode:"filter",sxProps:{background:t.palette.common.white,color:m.Z.primary.button,border:"1px solid ".concat(m.Z.primary.button),borderRadius:"8px",":hover":{background:t.palette.common.white}},sxPropsText:{fontSize:"16px",fontWeight:400},handleClick:function(){null===s||void 0===s||s()}})]})}var $=n(45987),K=n(33604),J=n(96467),X=["isOpen","handleClose","children"];function ee(e){var t=e.isOpen,n=e.handleClose,i=e.children,l=((0,$.Z)(e,X),(0,o.Z)());return(0,H.jsxs)(_.Z,{open:t,onClose:n,children:[(0,H.jsx)(K.Z,{sx:{padding:"0px"},children:(0,H.jsx)(B.ZP,{children:(0,H.jsx)(B.ZP,{sx:{height:"max-content",minWidth:"50vh",pt:"10px",alignItems:"center",display:"flex",flexDirection:"column",background:l.palette.common.white},children:(0,H.jsx)(y.Z,{onClick:n,sx:{p:0},className:"cursor-pointer absolute top-4 right-4",children:(0,H.jsx)("img",{src:G.Z,alt:"delete-icon",height:20,width:20})})})})}),(0,H.jsx)(J.Z,{sx:{padding:"0px"},children:!!i&&i})]})}var te=(0,x.forwardRef)((function(e,t){var n=(0,M.Wi)().actions,a=((0,p.s0)(),(0,o.Z)(),(0,S.kh)().actions),d=(0,u.$)(),c=d.t,m=(d.i18n,(0,D.I0)()),f=(0,D.v9)(F.i),Z=f.CityStarManagement,W=f.isLoading,z=(0,x.useMemo)((function(){return{page:1,limit:20}}),[]),_=(0,x.useState)(z),B=(0,i.Z)(_,2),G=B[0],V=B[1],Q=(0,x.useState)(!1),$=(0,i.Z)(Q,2),K=$[0],J=$[1],X=(0,x.useState)(!1),te=(0,i.Z)(X,2),ne=te[0],ie=te[1],oe=(0,x.useState)(""),le=(0,i.Z)(oe,2),re=le[0],se=le[1],ae=(0,x.useState)([]),de=(0,i.Z)(ae,2),ce=de[0],he=de[1],xe=(0,q.cI)(),ue=xe.control,pe=xe.formState.errors,me=xe.setError,ge=xe.watch,fe=xe.setValue,Ze=(0,x.useMemo)((function(){return[{id:"stt",label:"STT",align:"center",width:60},{id:"code",label:"M\xe3 th\u1ebb th\xe0nh vi\xean",align:"left",width:150},{id:"card_type",label:"Lo\u1ea1i th\u1ebb",width:110,align:"center"},{id:"qr_code",label:"M\xe3 QR",width:110,align:"left"},{id:"date_start",label:"Ng\xe0y t\u1ea1o",width:130,align:"left"},{id:"date_upadte",label:"Ng\xe0y c\u1eadp nh\u1eadt",width:130,align:"left"},{id:"expiration",label:"H\u1ea1n s\u1eed d\u1ee5ng",width:130,align:"left"},{id:"usage_status",label:"T\xecnh tr\u1ea1ng s\u1eed d\u1ee5ng",width:150,align:"center"}]}),[c]),be=(0,g.L0)({onFetchData:function(e){ye(e)},defaultFilter:z}),je=be.filter,ve=be.onFilterToQueryString,ye=function(e){m(n.fetchListCityStar(e))},Ce=function(){var e=(0,j.Z)((0,b.Z)().mark((function e(){var t,i,o,l,r,s,d,c;return(0,b.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(ce.length>0)){e.next=24;break}return t=[{header:"M\xe3 th\u1ebb",key:"code"},{header:"Lo\u1ea1i th\u1ebb",key:"typeCard"},{header:"Link",key:"linkDowloadQrCode"},{header:"H\u1ea1n th\u1ebb",key:"expiryDate"}],i=new(N().Workbook),e.prev=3,o="CityStar",(l=i.addWorksheet("Sheet-1")).columns=t,l.getRow(1).font={bold:!0},l.columns.forEach((function(e){e.width=e.header.length+10,e.alignment={horizontal:"center"}})),ce.forEach((function(e){l.addRow(e)})),l.eachRow({includeEmpty:!1},(function(e){e._cells.forEach((function(e){var t=e._address;l.getCell(t).border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}))})),e.next=13,i.xlsx.writeBuffer();case 13:r=e.sent,(0,P.saveAs)(new Blob([r]),"".concat(o,".xlsx")),ke(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(3),console.error("<<<ERRROR>>>",e.t0);case 21:return e.prev=21,i.removeWorksheet("Sheet-1"),e.finish(21);case 24:s=parseInt(ge("count")),d=ge("typeCard"),c={count:s,typeCard:d},m(n.postCodeGenerate(c,(function(e){if(null!==e&&void 0!==e&&e.success&&null!==e&&void 0!==e&&e.response){var t;he(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data)}else{var n,i;ke();var o=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.message;m(a.updateSnackbar({message:o||"T\u1ea1o m\xe3 th\u1ebb kh\xf4ng th\xe0nh c\xf4ng",type:"error"}))}})));case 28:case"end":return e.stop()}}),e,null,[[3,18,21,24]])})));return function(){return e.apply(this,arguments)}}(),we=function(e){se(e),ie(!0)};(0,x.useImperativeHandle)(t,(function(){return{openFromParent:function(){J(!0)}}}));var ke=function(){he([]),fe("typeCard",""),fe("count",""),J(!1)},Se=(0,x.useMemo)((function(){return[{id:1,key:"B\u1ea1c",value:T.G8.SIVER},{id:2,key:"V\xe0ng",value:T.G8.GOLD},{id:3,key:"Kim C\u01b0\u01a1ng",value:T.G8.DIAMOND},{id:4,key:"B\u1ea1ch Kim",value:T.G8.PLATINUM},{id:5,key:"\u0110\u1ed1i T\xe1c",value:T.G8.PARTNER},{id:6,key:"\u0110\u1ea1i S\u1ee9",value:T.G8.AMBASSADOR}]}),[]),Re=(0,x.useMemo)((function(){return[{label:"T\xecnh tr\u1ea1ng s\u1eed d\u1ee5ng",options:[{label:"Ch\u1ecdn t\xecnh tr\u1ea1ng",value:""},{label:"\u0110ang s\u1eed d\u1ee5ng",value:T.qb.ACTIVE},{label:"Ch\u01b0a s\u1eed d\u1ee5ng",value:T.qb.INACTIVE}],handleSelected:function(e){V((0,v.Z)((0,v.Z)({},G),{},{isActive:e===T.qb.ACTIVE}))}},{label:"Th\u1eddi gian",type:"date",placeholder:"Th\u1eddi gian t\u1ea1o",options:[],onChange:function(e){e?V((0,v.Z)((0,v.Z)({},G),{},{startDate:L()(e).format("YYYY-MM-DD")})):(null===G||void 0===G||delete G.startDate,V(G))}},{label:"Th\u1eddi gian k\u1ebft th\xfac",type:"date",placeholder:"Th\u1eddi gian k\u1ebft th\xfac",options:[],onChange:function(e){e?V((0,v.Z)((0,v.Z)({},G),{},{endDate:L()(e).format("YYYY-MM-DD")})):(null===G||void 0===G||delete G.endDate,V(G))}}]}),[G]);return(0,H.jsxs)(w.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,H.jsx)(U,{placeholder:c(h.I.common.search),isFilter:!0,filterList:Re,submitFilter:function(){ve((0,v.Z)((0,v.Z)({},G),{},{page:1}))}}),(0,H.jsx)(R.Z,{headers:Ze,onRequestSort:function(e,t){ve((0,v.Z)((0,v.Z)({},je),{},{sortByName:"true"===(null===je||void 0===je?void 0:je.sortByName)?"false":"true"}))},renderItem:function(e,t){return[(0,H.jsx)(k.D,{text:"".concat(t+1),line:1}),(0,H.jsx)(k.D,{text:"".concat(null===e||void 0===e?void 0:e.code),line:1,color:"#007AFF"}),(0,H.jsx)(k.D,{text:"".concat((0,O.dt)(e.typeCard)),line:1}),(0,H.jsx)(y.Z,{onClick:function(){return we(null===e||void 0===e?void 0:e.qrCode)},children:(0,H.jsx)("img",{src:A})}),(0,H.jsx)(k.D,{text:"".concat((0,O.tg)(e.createdAt)),line:1}),(0,H.jsx)(k.D,{text:"".concat((0,O.tg)(e.updatedAt)),line:1}),(0,H.jsx)(k.D,{text:"".concat((0,O.tg)(e.expiryDate)),line:1}),(0,H.jsx)(I.Z,{status:e.isActive?T.qb.USED:T.qb.NOTUSED})]},items:null===Z||void 0===Z?void 0:Z.data,pageNumber:je.page,totalElements:null===Z||void 0===Z?void 0:Z.total,sort:je.orderBy,limitElement:je.limit,onPageChange:function(e){ve((0,v.Z)((0,v.Z)({},je),{},{page:e}))},onPageSizeChange:function(e){ve((0,v.Z)((0,v.Z)({},je),{},{page:1,limit:e}))},isLoading:W,fullHeight:!0}),ne&&(0,H.jsx)(ee,{isOpen:ne,handleClose:function(){ie(!1)},children:(0,H.jsx)("img",{src:re,style:{height:"100%",width:"100%"}})}),K&&(0,H.jsxs)(Y,{isOpen:K,handleClose:ke,handleSubmit:Ce,actionName:ce.length>0?"T\u1ea3i m\xe3 th\u1ebb":"T\u1ea1o m\xe3",hideCancelButton:!(ce.length>0),children:[(0,H.jsx)(r.Z,{fontWeight:700,fontSize:"24px",children:"T\u1ea1o m\xe3 th\u1ebb th\xe0nh vi\xean CT Star"}),ce.length>0?(0,H.jsxs)(l.Z,{sx:{width:"100%"},children:[(0,H.jsxs)(r.Z,{fontSize:"14px",fontWeight:500,my:2,children:["S\u1ed1 m\xe3 \u0111\u01b0\u1ee3c t\u1ea1o: ",ce.length]}),(0,H.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",background:"#FEF4FA",height:"45px",borderRadius:"8px",px:2,width:"100%"},children:[(0,H.jsx)(l.Z,{width:"15%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:700,children:"STT"})}),(0,H.jsx)(l.Z,{width:"20%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:700,children:"Lo\u1ea1i th\u1ebb"})}),(0,H.jsx)(l.Z,{width:"45%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:700,children:"M\xe3 th\u1ebb th\xe0nh vi\xean"})}),(0,H.jsx)(l.Z,{width:"20%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:700,children:"M\xe3 QR"})})]}),(0,H.jsx)(l.Z,{style:{height:"45vh",overflow:"auto"},children:ce.map((function(e,t){return(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(l.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",px:3,width:"100%"},children:[(0,H.jsx)(l.Z,{width:"15%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:400,children:t+1})}),(0,H.jsx)(l.Z,{width:"20%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:400,children:null===e||void 0===e?void 0:e.typeCard})}),(0,H.jsx)(l.Z,{width:"45%",children:(0,H.jsx)(r.Z,{fontSize:"14px",fontWeight:400,color:"#007AFF",children:null===e||void 0===e?void 0:e.code})}),(0,H.jsx)(l.Z,{width:"20%",onClick:function(){return we(null===e||void 0===e?void 0:e.qrCode)},children:(0,H.jsx)(y.Z,{children:(0,H.jsx)("img",{src:A})})})]}),(0,H.jsx)(C.Z,{})]})}))})]}):(0,H.jsxs)(s.Z,{flexDirection:"row",mt:4,width:"100%",children:[(0,H.jsx)(l.Z,{width:"50%",children:(0,H.jsx)(E.Z,{placeholder:"Ch\u1ecdn lo\u1ea1i th\u1ebb",label:"Lo\u1ea1i th\u1ebb",isRequired:!0,name:"typeCard",control:ue,errors:pe,setError:me,type:"select",options:Se})}),(0,H.jsx)(l.Z,{ml:2,width:"50%",children:(0,H.jsx)(E.Z,{placeholder:"Nh\u1eadp s\u1ed1 l\u01b0\u1ee3ng",label:"S\u1ed1 l\u01b0\u1ee3ng t\u1ea1o m\xe3",isRequired:!0,name:"count",control:ue,format:"number",errors:pe,setError:me,endAdornment:"M\xe3"})})]})]})]})})),ne=te,ie=n(31421);function oe(){var e=(0,o.Z)(),t=(0,u.$)().t,n=((0,p.s0)(),(0,x.useRef)(null)),b=(0,x.useRef)(null),j=(0,x.useState)(!1),v=(0,i.Z)(j,2),y=v[0],C=v[1],w=(0,g.Un)();return(0,H.jsxs)(x.Fragment,{children:[(0,H.jsx)(l.Z,{sx:{display:"flex",justifyContent:"end",paddingLeft:{xs:"12px",sm:"24px",lg:"0px"},paddingRight:{xs:"12px",sm:"24px",lg:"0px"}}}),(0,H.jsxs)(l.Z,{bgcolor:e.palette.grey[0],p:3,sx:{marginLeft:{xs:"12px",sm:"24px",lg:"0px"},marginRight:{xs:"12px",sm:"24px",lg:"0px"},borderRadius:3,mt:"-10px",minHeight:"calc(99%)"},children:[(0,H.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"50px"},children:[(0,H.jsx)(r.Z,{fontSize:"20px",fontWeight:"700",color:m.Z.primary.text,children:t(h.I.sidebar.membershipCityStar)}),(0,H.jsxs)(s.Z,{flexDirection:"row",children:[(0,H.jsx)(c.Z,{title:"T\u1ea3i m\xe3 th\u1ebb",isIcon:!0,isHide:!(0,O.wI)(ie.T.QRCODE_VIEW_ALL,w),propRef:n,buttonMode:"download",sxProps:{background:m.Z.primary.button,borderRadius:1,mb:"20px"},handleClick:function(){C(!0)}}),(0,H.jsx)(f.Z,{open:y,onClose:function(){C(!1)},anchorEl:n.current,sx:{width:"max-content"},children:(0,H.jsx)(a.Z,{children:(0,H.jsx)(d.Z,{sx:{":hover":{backgroundColor:"#FDEAF4"},m:"6px",borderRadius:"4px"},children:(0,H.jsx)(l.Z,{display:"flex",alignItems:"center",onClick:function(){Z.Z.downloadMembershipExcel()},children:(0,H.jsx)(r.Z,{ml:1,fontSize:"14px",fontWeight:400,color:e.palette.common.black,children:"T\u1ea3i danh s\xe1ch m\xe3 th\u1ebb"})})})})}),(0,H.jsx)(c.Z,{title:"T\u1ea1o m\xe3 th\u1ebb",isIcon:!0,isHide:!(0,O.wI)(ie.T.QRCODE_CREATE,w),buttonMode:"create",sxProps:{background:m.Z.primary.button,borderRadius:1,mb:"20px",ml:2},handleClick:function(){b.current&&b.current.openFromParent()}})]})]}),(0,H.jsx)(ne,{ref:b})]})]})}}}]);