"use strict";(self.webpackChunkctlotus_valuation=self.webpackChunkctlotus_valuation||[]).push([[960],{93960:function(e,t,n){n.r(t),n.d(t,{Comisstion:function(){return _}});var i=n(19860),o=n(10437),l=n(61113),r=n(25645),a=n(14310),s=n(27314),c=n(47313),d=n(24511),x=n(97890),u=n(31538),p=n(68161),h=n(31421),f=n(26002),m=n(74165),g=n(93433),v=n(15861),b=n(1413),Z=n(29439),j=n(70501),C=n(35898),w=n(65033),S=n(63501),y=n(64351),k=n(2220),D=n(76077),I=n(29466),F=n(7791),z=n(83294),P=n(4942),W=n(17592),A=(0,W.ZP)(o.Z)((function(e){var t,n=e.theme;return t={width:"340px",display:"inline-flex",backgroundColor:"".concat(n.palette.common.white," !important"),alignItems:"center",borderRadius:"8px",height:"41px"},(0,P.Z)(t,n.breakpoints.down("sm"),{width:"100%"}),(0,P.Z)(t,"input",{fontSize:"16px",paddingLeft:"16px",border:"none",height:"100%",width:"100%",outline:"none",background:"".concat(n.palette.secondary.lighter)}),t})),L=((0,W.ZP)("img")((function(e){e.theme;return{width:"40px",height:"40px",paddingLeft:"16px"}})),n(46417));function T(e){var t=(0,i.Z)(),n=(0,d.$)().t,a=e.onChangeSearchInput,x=(e.placeholder,e.filterListPhase),p=e.filterListDate,h=e.isFilter,f=e.submitFilter,m=e.filterList,g=(0,I.lr)(),v=(0,Z.Z)(g,2),b=v[0],j=(v[1],(0,c.useState)((function(){var e;return null!==b&&void 0!==b&&b.get("query")?null===b||void 0===b||null===(e=b.get("query"))||void 0===e?void 0:e.replace("%2B","+"):""}))),C=(0,Z.Z)(j,2),w=C[0],S=C[1],y=(0,c.useRef)();return(0,L.jsxs)(o.Z,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},color:t.palette.secondary.contrastText,bgcolor:u.Z.primary.barList,borderRadius:"8px",mb:"15px",p:"20px 20px 8px 20px",height:{xs:"198px",sm:"100px",md:"72px"}},children:[(0,L.jsxs)(A,{className:"input",sx:{bgcolor:u.Z.common.white,"& input::placeholder":{color:"#AFAFAF"},border:"1px solid #D3D3D3",borderRadius:"8px",mr:"15px",width:{md:"200px"}},children:[(0,L.jsx)(l.Z,{sx:{fontSize:14,fontWeight:500,color:"#222222",background:t.palette.common.white,p:"0px 8px 0px 8px",mb:"45px",ml:"12px",position:"absolute"},children:"T\u1eeb kho\xe1 t\xecm ki\u1ebfm"}),(0,L.jsx)("input",{style:{borderRadius:"8px",backgroundColor:u.Z.common.white,fontSize:14,fontWeight:400,paddingRight:"15px"},type:"text",placeholder:"Nh\u1eadp t\u1eeb kho\xe1 t\xecm ki\u1ebfm",onChange:function(e){S(e.target.value),y.current&&clearTimeout(y.current),y.current=setTimeout((function(){a(e.target.value.replaceAll("+","%2B"))}),500)},value:w})]}),(0,L.jsxs)(o.Z,{sx:{display:"flex",gap:{xs:"12px",sm:"0px"},alignItems:"center"},children:[null===m||void 0===m?void 0:m.map((function(e){return(0,L.jsx)(c.Fragment,{children:(0,L.jsx)(z.Z,{label:e.label,list:e.options,handleSelected:e.handleSelected})},e.label)})),null===x||void 0===x?void 0:x.map((function(e){return(0,L.jsx)(c.Fragment,{children:(0,L.jsx)(z.Z,{label:e.label,list:e.options,handleSelected:e.handleSelected})},e.label)}))]}),(0,L.jsxs)(o.Z,{sx:{display:"flex",gap:{xs:"12px",sm:"0px"},alignItems:"center"},children:[null===p||void 0===p?void 0:p.map((function(e){return(0,L.jsx)(c.Fragment,{children:(0,L.jsx)(F.Z,{onChange:e.onChange,placeholder:null===e||void 0===e?void 0:e.placeholder})},e.label)})),(0,L.jsx)(l.Z,{sx:{fontSize:14,fontWeight:500,color:"#222222",background:t.palette.common.white,p:"0px 8px 0px 8px",mb:"47px",ml:"12px",position:"absolute"},children:"Th\u1eddi gian"})]}),h&&(0,L.jsx)(r.Z,{title:n(s.I.common.search),buttonMode:"filter",sxProps:{background:t.palette.common.white,color:u.Z.primary.button,border:"1px solid ".concat(u.Z.primary.button),p:0,borderRadius:"8px",width:"100px",":hover":{background:t.palette.common.white}},sxPropsText:{fontSize:"14px",fontWeight:400},handleClick:function(){null===f||void 0===f||f()}})]})}var N=n(10658),M=n.n(N),R=n(33222),B=n(17092),O=n(52387),Y=n(49248),E=n(6979),G=n(37874);function H(){var e,t=(0,Y.bz)().actions,n=((0,x.s0)(),(0,i.Z)(),(0,y.kh)().actions),r=(0,d.$)(),a=r.t,u=(r.i18n,(0,R.I0)()),I=(0,f.Un)(),F=(0,R.v9)(E.W),z=F.ComisstionManagement,P=F.isLoading,W=F.ComisstionDetail,A=(0,c.useMemo)((function(){return{page:1,limit:20}}),[]),N=(0,R.v9)(D.H).projectList,H=(0,c.useState)(A),_=(0,Z.Z)(H,2),U=_[0],q=_[1],K=(0,c.useState)(-1),V=(0,Z.Z)(K,2),$=V[0],X=V[1],Q=(0,c.useState)(-1),J=(0,Z.Z)(Q,2),ee=J[0],te=J[1],ne=(0,c.useState)(""),ie=(0,Z.Z)(ne,2),oe=ie[0],le=ie[1],re=(0,c.useState)([]),ae=(0,Z.Z)(re,2),se=ae[0],ce=ae[1],de=(0,c.useState)([]),xe=(0,Z.Z)(de,2),ue=xe[0],pe=xe[1],he=(0,c.useState)([{label:"Ch\u1ecdn d\u1ef1 \xe1n",value:""}]),fe=(0,Z.Z)(he,2),me=fe[0],ge=fe[1],ve=(0,c.useState)(-1),be=(0,Z.Z)(ve,2),Ze=be[0],je=be[1],Ce=(0,c.useMemo)((function(){return[{id:"code",label:"M\xe3 NVKD",align:"left",width:100},{id:"staffName",label:"T\xean nh\xe2n vi\xean",width:160,align:"left"},{id:"orgChart",label:"\u0110\u01a1n v\u1ecb",width:140,align:"left"},{id:"position",label:"Ch\u1ee9c danh",width:140,align:"left"},{id:"totalPriceBroker",label:"Ph\xed m\xf4i gi\u1edbi",width:140,align:"left"},{id:"supportCost",label:"Ph\xed h\u1ed7 tr\u1ee3",width:140,align:"left"}]}),[a]),we=(0,f.L0)({onFetchData:function(e){ke(e)},defaultFilter:A}),Se=we.filter,ye=we.onFilterToQueryString;(0,c.useEffect)((function(){if(null!==W&&void 0!==W&&W.data){var e,t=null===W||void 0===W||null===(e=W.data)||void 0===e?void 0:e.filter((function(e){return!0===e.isPaid})).length;je(t)}}),[W]),(0,c.useEffect)((function(){if(null!==N&&void 0!==N&&N.data){var e,t=[{label:"Ch\u1ecdn d\u1ef1 \xe1n",value:""}];null===(e=N.data)||void 0===e||e.forEach((function(e){t.push({label:e.name,value:e.name})})),ge(t)}}),[N]);var ke=function(e){u(t.fetchListComisstion(e))},De=function(e,t){ye((0,b.Z)((0,b.Z)({},Se),{},{sortByName:"true"===(null===Se||void 0===Se?void 0:Se.sortByName)?"false":"true"}))},Ie=function(e){ye((0,b.Z)((0,b.Z)({},Se),{},{page:e}))},Fe=function(e){ye((0,b.Z)((0,b.Z)({},Se),{},{page:1,take:e}))},ze=function(e){pe(e)},Pe=function(e,t){var n,i,o,l,r;return[(0,L.jsx)(S.D,{text:"".concat(null===e||void 0===e||null===(n=e.staff)||void 0===n?void 0:n.code),line:1,color:"#007AFF"}),(0,L.jsx)(S.D,{text:"".concat(null===e||void 0===e||null===(i=e.staff)||void 0===i?void 0:i.fullName),line:2}),(0,L.jsx)(S.D,{text:"".concat(null===e||void 0===e||null===(o=e.staff)||void 0===o||null===(l=o.orgChart)||void 0===l?void 0:l.name),line:2}),(0,L.jsx)(S.D,{text:"".concat(null===e||void 0===e||null===(r=e.staff)||void 0===r?void 0:r.position),line:2}),(0,L.jsx)(S.D,{text:"".concat((0,p.xG)(null===e||void 0===e?void 0:e.moneyComing),"\u0111"),line:1}),(0,L.jsx)(S.D,{text:"".concat((0,p.xG)((null===e||void 0===e?void 0:e.supportCost)||0),"\u0111"),line:1})]},We=(0,c.useMemo)((function(){return[{label:"Tr\u1ea1ng th\xe1i",options:[{label:"Ch\u1ecdn tr\u1ea1ng th\xe1i",value:""},{label:"Ch\u01b0a chi",value:O.g8.UNPAID},{label:"\u0110ang chi",value:O.g8.PAYING},{label:"\u0110\xe3 chi",value:O.g8.PAID}],handleSelected:function(e){q((0,b.Z)((0,b.Z)({},U),{},{status:e}))}}]}),[U]),Ae=(0,c.useMemo)((function(){return[{label:"Th\u1eddi gian",type:"date",placeholder:"T\u1eeb ng\xe0y",options:[],onChange:function(e){e?q((0,b.Z)((0,b.Z)({},U),{},{startDate:M()(e).format("YYYY-MM-DD")})):(null===U||void 0===U||delete U.startDate,q(U))}},{label:"",type:"date",placeholder:"\u0110\u1ebfn ng\xe0y",options:[],onChange:function(e){e?q((0,b.Z)((0,b.Z)({},U),{},{endDate:M()(e).format("YYYY-MM-DD")})):(null===U||void 0===U||delete U.endDate,q(U))}}]}),[U]),Le=(0,c.useMemo)((function(){return[{label:"D\u1ef1 \xe1n",options:me,handleSelected:function(e){q((0,b.Z)((0,b.Z)({},U),{},{projectName:e}))}}]}),[U,me]),Te=function(e,n,i){X(e),ce([]),pe([]),te(i),e||u(t.fetchListComisstion(Se)),u(t.getDetailComisstion({id:n}))},Ne=function(){var e=(0,v.Z)((0,m.Z)().mark((function e(){var i,o,l;return(0,m.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=(0,g.Z)(se).concat(ue),ce(i),o=[],ue.forEach((function(e,t){o.push(e.id)})),l={commissionDetailIds:o},u(t.updateStatusComisstion(l,(function(e){null!==e&&void 0!==e&&e.success&&(u(n.updateSnackbar({message:"C\u1eadp nh\u1eadt th\xe0nh c\xf4ng",type:"success"})),pe([]),u(t.fetchListComisstion(Se)))})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Me=function(e,t){var n=e,i=(null===W||void 0===W?void 0:W.data.length)||0,o=se.length+Ze;return t!==ee?e:(0===o?n=O.g8.UNPAID:o>0&&o<i?n=O.g8.PAYING:o===i&&(n=O.g8.PAID),n)};return(0,L.jsxs)(j.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,L.jsx)(T,{onChangeSearchInput:function(e){le(e)},placeholder:a(s.I.common.search),isFilter:!0,filterList:Le,filterListDate:Ae,filterListPhase:We,submitFilter:function(){ye((0,b.Z)((0,b.Z)({},U),{},{page:1,search:oe}))}}),null===z||void 0===z||null===(e=z.data)||void 0===e?void 0:e.map((function(e,t){var n,i=ue.length>0&&$===t;return(0,L.jsxs)(L.Fragment,{children:[(0,L.jsxs)(o.Z,{sx:{width:"100%",mt:"8px",background:"#E7F8F8",padding:"8px 15px 8px 15px",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"44px"},children:[(0,L.jsxs)(C.Z,{sx:{alignItems:"center",flexDirection:"row",cursor:"pointer"},onClick:function(){return Te($===t?-1:t,e.id,t)},children:[(0,L.jsx)(l.Z,{sx:{fontSize:"25px",color:"black",width:"30px"},children:$===t?"-":"+"}),(0,L.jsx)(G.Z,{status:Me(e.status,t)})]}),(0,L.jsxs)(C.Z,{style:{cursor:"pointer",flexDirection:"row",flexGrow:1,display:"inline"},onClick:function(){return Te($===t?-1:t,e.id,t)},children:[(0,L.jsxs)(C.Z,{flexDirection:"row",justifyContent:"space-between",children:[(0,L.jsxs)(C.Z,{flexDirection:"row",alignItems:"center",children:[(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black",ml:3},children:e.product.project.name}),(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"#007AFF",ml:1},children:e.product.code}),(0,L.jsxs)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:2},children:[(0,p.xG)(e.product.priceVat),"\u0111(VAT)"]}),(0,L.jsxs)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:2},children:[(0,p.xG)(e.product.price),"\u0111"]})]}),(0,L.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black"},children:"Thanh to\xe1n:"}),(0,L.jsxs)(l.Z,{sx:{fontSize:"14px",fontWeight:"600",color:"black",ml:1},children:[(0,p.xG)(e.revenue),"\u0111"]}),(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black",ml:2},children:"T\u1ec9 l\u1ec7:"}),(0,L.jsxs)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:1},children:[(0,p.sR)(100*e.paymentRate,1),"%"]})]})]}),(0,L.jsxs)(C.Z,{flexDirection:"row",justifyContent:"space-between",children:[(0,L.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black",ml:3},children:"Kh\xe1ch h\xe0ng:"}),(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:1,whiteSpace:"nowrap",maxWidth:"30vw",textOverflow:"ellipsis",overflow:"hidden"},children:e.customerName})]}),(0,L.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black"},children:"Ng\xe0y t\u1ea1o:"}),(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:.5},children:(0,p.tg)(e.createdAt)})]})]}),(0,L.jsx)(C.Z,{flexDirection:"row",justifyContent:"space-between",children:(0,L.jsxs)(o.Z,{display:"flex",alignItems:"center",children:[(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:"black",ml:3},children:"T\u1ed5ng:"}),(0,L.jsxs)(l.Z,{sx:{fontSize:"14px",fontWeight:"500",color:"black",ml:1,whiteSpace:"nowrap",maxWidth:"30vw",textOverflow:"ellipsis",overflow:"hidden"},children:[(0,p.xG)(e.value),"\u0111"]})]})})]}),(0,L.jsx)("div",{style:{display:"flex",alignItems:"center",marginLeft:15},children:(0,L.jsx)("div",{children:(0,L.jsx)("div",{style:{display:(0,p.wI)(h.T.COMMISSION_PAID,I)?"flex":"none",border:"1px solid ".concat(i?"#2FB350":"#C8CBCF"),background:i?"#fff":"#C8CBCF",borderRadius:"8px",padding:"2px 8px",minHeight:"32px",justifyContent:"center",alignItems:"center",cursor:i?" pointer":"default"},onClick:function(){i&&Ne()},children:(0,L.jsx)(l.Z,{sx:{fontSize:"14px",fontWeight:"700",color:i?"#2FB350":"#7A7A7A"},children:"X\xe1c nh\u1eadn chi"})})})})]}),(0,L.jsx)(w.Z,{in:$===t,timeout:"auto",unmountOnExit:!0,children:(0,L.jsx)(k.Z,{headers:Ce,onRequestSort:De,renderItem:Pe,items:null===W||void 0===W?void 0:W.data,pageNumber:Se.page,totalElements:null===W||void 0===W?void 0:W.total,countDisabledList:null===W||void 0===W||null===(n=W.data)||void 0===n?void 0:n.filter((function(e){return!0===e.isPaid})).length,sort:Se.orderBy,limitElement:null===W||void 0===W?void 0:W.total,onPageChange:Ie,onPageSizeChange:Fe,listCheckBox:se,isLoading:P,hidePagination:!0,hasCheckbox:(0,p.wI)(h.T.COMMISSION_PAID,I),onSelectCheckbox:ze,typeCheckBox:B.D.CHECKBOX,fullHeight:!0})})]})}))]})}function _(){var e=(0,i.Z)(),t=(0,d.$)().t,n=(0,f.Un)(),m=(0,x.s0)();return(0,L.jsxs)(c.Fragment,{children:[(0,L.jsx)(o.Z,{sx:{display:"flex",justifyContent:"end",paddingLeft:{xs:"12px",sm:"24px",lg:"0px"},paddingRight:{xs:"12px",sm:"24px",lg:"0px"}}}),(0,L.jsxs)(o.Z,{bgcolor:e.palette.grey[0],p:3,sx:{marginLeft:{xs:"12px",sm:"24px",lg:"0px"},marginRight:{xs:"12px",sm:"24px",lg:"0px"},borderRadius:3,mt:"-10px",minHeight:"calc(99%)"},children:[(0,L.jsxs)(o.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"50px"},children:[(0,L.jsx)(l.Z,{fontSize:"20px",fontWeight:"700",color:u.Z.primary.text,children:t(s.I.sidebar.transListDetail)}),(0,L.jsx)(r.Z,{title:t(s.I.common.createAccount),isHide:!(0,p.wI)(h.T.TRANSACTION_IMPORT,n),isIcon:!0,buttonMode:"create",sxProps:{background:u.Z.primary.button,borderRadius:1,mb:"20px"},handleClick:function(){return m(a.Z.uploadComisstion)}})]}),(0,L.jsx)(H,{})]})]})}}}]);