"use strict";(self.webpackChunkctlotus_valuation=self.webpackChunkctlotus_valuation||[]).push([[606],{69606:function(e,t,n){n.r(t),n.d(t,{Staff:function(){return Q}});var i=n(19860),l=n(10437),o=n(47313),a=n(74165),r=n(15861),s=n(1413),c=n(29439),d=n(70501),u=n(9019),p=n(61113),x=n(48310),h=n(45624),f=n(25645),m=n(63501),g=n(75184),v=n(95688),b=n(64351),Z=n(2220),j=n(26002),w=n(32718),S=n(99349),C=n(65310),k=n(30282),y=n(14310),F=n(81511),T=n(27314),R=n(24511),I=n(33222),E=n(97890),D=n(29466),L=n(65165),A=n(31538),P=n(52387),M=n(31421),z=n(68161),W=n(18301),_=n(36541),N=n(7791),U=n(83294),q=n(4942),H=n(17592),V=(0,H.ZP)(l.Z)((function(e){var t,n=e.theme;return t={width:"340px",display:"inline-flex",backgroundColor:"".concat(n.palette.common.white," !important"),alignItems:"center",borderRadius:"8px",height:"41px"},(0,q.Z)(t,n.breakpoints.down("sm"),{width:"100%"}),(0,q.Z)(t,"input",{fontSize:"16px",paddingLeft:"16px",border:"none",height:"100%",width:"100%",outline:"none",background:"".concat(n.palette.secondary.lighter)}),t})),B=((0,H.ZP)("img")((function(e){e.theme;return{width:"40px",height:"40px",paddingLeft:"16px"}})),n(46417));function O(e){var t=(0,i.Z)(),n=(0,R.$)().t,a=e.onChangeSearchInput,r=(e.placeholder,e.filterListPhase),s=e.filterListDate,d=e.isFilter,u=e.submitFilter,x=e.filterList,h=(0,D.lr)(),m=(0,c.Z)(h,2),g=m[0],v=(m[1],(0,o.useState)((function(){var e;return null!==g&&void 0!==g&&g.get("query")?null===g||void 0===g||null===(e=g.get("query"))||void 0===e?void 0:e.replace("%2B","+"):""}))),b=(0,c.Z)(v,2),Z=b[0],j=b[1],w=(0,o.useRef)();return(0,B.jsxs)(l.Z,{sx:{display:"flex",flexDirection:{xs:"column",md:"row"},color:t.palette.secondary.contrastText,bgcolor:A.Z.primary.barList,borderRadius:"8px",mb:"15px",p:"20px 20px 8px 20px",height:{xs:"198px",sm:"100px",md:"72px"}},children:[(0,B.jsxs)(V,{className:"input",sx:{bgcolor:A.Z.common.white,"& input::placeholder":{color:"#AFAFAF"},border:"1px solid #D3D3D3",borderRadius:"8px",mr:"15px",width:{md:"260px"}},children:[(0,B.jsx)(p.Z,{sx:{fontSize:14,fontWeight:500,color:"#222222",background:t.palette.common.white,p:"0px 8px 0px 8px",mb:"45px",ml:"12px",position:"absolute"},children:"T\u1eeb kho\xe1 t\xecm ki\u1ebfm"}),(0,B.jsx)("input",{style:{borderRadius:"8px",backgroundColor:A.Z.common.white,fontSize:14,fontWeight:400,paddingRight:"15px"},type:"text",placeholder:"Nh\u1eadp t\u1eeb kho\xe1 t\xecm ki\u1ebfm",onChange:function(e){j(e.target.value),w.current&&clearTimeout(w.current),w.current=setTimeout((function(){a(e.target.value.replaceAll("+","%2B"))}),500)},value:Z})]}),(0,B.jsxs)(l.Z,{sx:{marginTop:{xs:"12px",md:"0px"},display:"flex",flexDirection:{xs:"column",sm:"row"},gap:{xs:"12px",sm:"0px"}},children:[null===x||void 0===x?void 0:x.map((function(e){return(0,B.jsx)(o.Fragment,{children:(0,B.jsx)(U.Z,{label:e.label,list:e.options,handleSelected:e.handleSelected})},e.label)})),null===r||void 0===r?void 0:r.map((function(e){return(0,B.jsx)(o.Fragment,{children:(0,B.jsx)(U.Z,{label:e.label,list:e.options,handleSelected:e.handleSelected})},e.label)})),(0,B.jsx)(l.Z,{sx:{display:"flex",gap:{xs:"12px",sm:"0px"},alignItems:"center"},children:null===s||void 0===s?void 0:s.map((function(e){return(0,B.jsx)(o.Fragment,{children:(0,B.jsx)(N.Z,{onChange:e.onChange,placeholder:null===e||void 0===e?void 0:e.placeholder})},e.label)}))}),d&&(0,B.jsx)(f.Z,{title:n(T.I.common.search),buttonMode:"filter",sxProps:{background:t.palette.common.white,color:A.Z.primary.button,border:"1px solid ".concat(A.Z.primary.button),borderRadius:"8px",minWidth:"100px",":hover":{background:t.palette.common.white}},sxPropsText:{fontSize:"14px",fontWeight:400},handleClick:function(){null===u||void 0===u||u()}})]})]})}function $(){var e=(0,W.nW)().actions,t=(0,i.Z)(),n=(0,j.Un)(),N=(0,E.s0)(),U=(0,R.$)().t,q=(0,I.I0)(),H=(0,w.Cj)().actions,V=(0,C.iD)().actions,$=(0,o.useRef)(null),Q=(0,o.useRef)(null),G=(0,I.v9)(_.Z),J=G.staffManagement,K=G.isLoading,X=(0,I.v9)(S.p).OrgchartManagement,Y=(0,o.useState)(!1),ee=(0,c.Z)(Y,2),te=ee[0],ne=ee[1],ie=(0,I.v9)(k.P).rolesManager,le=(0,o.useMemo)((function(){return{page:1,limit:20}}),[]),oe=(0,o.useState)(le),ae=(0,c.Z)(oe,2),re=ae[0],se=ae[1],ce=(0,o.useState)(""),de=(0,c.Z)(ce,2),ue=de[0],pe=de[1],xe=(0,o.useState)([{label:"Ch\u1ecdn \u0111\u01a1n v\u1ecb",value:""}]),he=(0,c.Z)(xe,2),fe=he[0],me=he[1],ge=(0,o.useState)([{label:"Ch\u1ecdn vai tr\xf2",value:""}]),ve=(0,c.Z)(ge,2),be=ve[0],Ze=ve[1],je=(0,o.useMemo)((function(){return[{id:"code",label:"M\xe3 nh\xe2n vi\xean",align:"center",width:130},{id:"name",label:"T\xean nh\xe2n vi\xean",align:"left",width:180},{id:"phone",label:"\u0110i\u1ec7n tho\u1ea1i",width:130,align:"left"},{id:"email",label:"Email",width:200,align:"left"},{id:"unit",label:"\u0110\u01a1n v\u1ecb l\xe0m vi\u1ec7c",width:180,align:"left"},{id:"position",label:"C\u1ea5p b\u1eadc",width:130,align:"left"},{id:"from",label:"Ch\u1ee9c danh",width:200,align:"left"},{id:"status",label:"Tr\u1ea1ng th\xe1i",width:110,align:"left"},{id:"userUuid",label:"",width:70,align:"left"}]}),[U]);(0,o.useEffect)((function(){var e=[{label:"Ch\u1ecdn \u0111\u01a1n v\u1ecb",value:""}];null===X||void 0===X||X.data.forEach((function(t){e.push({label:null===t||void 0===t?void 0:t.name,value:null===t||void 0===t?void 0:t.name})})),me(e)}),[null===X||void 0===X?void 0:X.data]),(0,o.useEffect)((function(){var e=[{label:"Ch\u1ecdn ch\u1ee9c danh",value:""}];null===ie||void 0===ie||ie.data.forEach((function(t,n){"sysadmin"!==t.name&&e.push({label:null===t||void 0===t?void 0:t.name,value:null===t||void 0===t?void 0:t.name})})),Ze(e)}),[null===ie||void 0===ie?void 0:ie.data]);var we=(0,j.L0)({onFetchData:function(e){ke(e)},defaultFilter:le}),Se=we.filter,Ce=we.onFilterToQueryString,ke=function(t){q(e.fetchListStaff(t)),q(V.fetchListRole(t)),ye()},ye=function(){q(H.fetchListOrgchart())},Fe=(0,o.useMemo)((function(){return[{label:"\u0110\u01a1n v\u1ecb l\xe0m vi\u1ec7c",options:fe,handleSelected:function(e){se((0,s.Z)((0,s.Z)({},re),{},{workingUnit:e}))}},{label:"Ch\u1ee9c danh",options:be,handleSelected:function(e){se((0,s.Z)((0,s.Z)({},re),{},{position:e}))}}]}),[re,fe,be,ue]),Te=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.files){e.next=5;break}return e.next=3,L.Z.uploadFileStaff(t.target.files[0]);case 3:e.sent?(ke(Se),q(b.NV.updateSnackbar({message:"Upload file excel th\xe0nh c\xf4ng",type:"success"}))):q(b.NV.updateSnackbar({message:"Upload file excel kh\xf4ng th\xe0nh c\xf4ng",type:"error"}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=function(){ne(!0)};return(0,B.jsxs)(d.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,B.jsxs)(u.ZP,{xs:12,sm:12,sx:{display:"flex",justifyContent:"space-between",mb:2},children:[(0,B.jsx)(l.Z,{display:"flex",sx:{alignItems:"center"},children:(0,B.jsx)(p.Z,{fontSize:"20px",fontWeight:700,lineHeight:"24px",children:"Danh s\xe1ch nh\xe2n vi\xean"})}),(0,B.jsxs)(l.Z,{display:"flex",children:[(0,B.jsx)(f.Z,{title:"Upload file Excel",isHide:!(0,z.wI)(M.T.STAFF_CREATE,n),isIcon:!0,buttonMode:"excel",sxProps:{background:A.Z.primary.button,borderRadius:1,mb:"20px"},handleClick:function(){var e;null===(e=Q.current)||void 0===e||e.click()}}),(0,B.jsx)("input",{type:"file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ref:Q,onChange:Te,style:{display:"none"}}),(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(f.Z,{title:"T\u1ea3i",isIcon:!0,isHide:!(0,z.wI)(M.T.STAFF_CREATE,n),propRef:$,buttonMode:"download",sxProps:{background:A.Z.primary.button,borderRadius:1,m:"0px 15px 20px 15px"},handleClick:Re}),(0,B.jsx)(g.Z,{open:te,onClose:function(){ne(!1)},anchorEl:$.current,sx:{width:"max-content"},children:(0,B.jsx)(x.Z,{children:(0,B.jsx)(h.Z,{sx:{":hover":{backgroundColor:"#FDEAF4"},m:"6px",borderRadius:"4px"},onClick:Re,children:(0,B.jsx)(D.rU,{style:{color:"transparent"},to:"/static/template/template_Staff.xlsx",download:"Template_Staff",target:"_blank",children:(0,B.jsx)(l.Z,{display:"flex",alignItems:"center",children:(0,B.jsx)(p.Z,{ml:1,fontSize:"14px",fontWeight:400,color:t.palette.common.black,children:"T\u1ea3i template"})})})})})})]}),(0,B.jsx)(f.Z,{title:"Th\xeam m\u1edbi",isIcon:!0,isHide:!(0,z.wI)(M.T.STAFF_CREATE,n),buttonMode:"create",sxProps:{background:A.Z.primary.button,color:A.Z.common.white,borderRadius:"8px"},sxPropsText:{fontSize:"14px",fontWeight:700},handleClick:function(){return N(y.Z.createStaff)}})]})]}),(0,B.jsx)(O,{onChangeSearchInput:function(e){pe(e),Ce((0,s.Z)((0,s.Z)({},Se),{},{search:e,page:1}))},placeholder:U(T.I.common.search),isFilter:!0,filterList:Fe,submitFilter:function(){Ce((0,s.Z)((0,s.Z)({},re),{},{page:1,search:ue}))}}),(0,B.jsx)(Z.Z,{headers:je,onRequestSort:function(e,t){},renderItem:function(e,t){var n;return[(0,B.jsx)(m.D,{text:e.code,line:1,color:"#007AFF"}),(0,B.jsx)(m.D,{text:e.fullName,line:2}),(0,B.jsx)(m.D,{text:e.phone,line:1}),(0,B.jsx)(m.D,{text:e.email,line:1}),(0,B.jsx)(m.D,{text:null===(n=e.orgChart)||void 0===n?void 0:n.name,line:1}),(0,B.jsx)(m.D,{text:(0,z.ee)(null===e||void 0===e?void 0:e.staffLevel),line:1}),(0,B.jsx)(m.D,{text:e.position,line:1}),(0,B.jsx)(v.Z,{status:e.staffStatus?P.qb.ACTIVE:P.qb.INACTIVE}),(0,B.jsx)("div",{children:(0,B.jsx)("img",{src:F.Z})})]},items:null===J||void 0===J?void 0:J.data,pageNumber:Se.page,totalElements:null===J||void 0===J?void 0:J.total,sort:Se.orderBy,limitElement:Se.limit,onPageChange:function(e){Ce((0,s.Z)((0,s.Z)({},Se),{},{page:e}))},onPageSizeChange:function(e){Ce((0,s.Z)((0,s.Z)({},Se),{},{page:1,limit:e}))},onClickRow:function(e){N("/staff/".concat(null===e||void 0===e?void 0:e.id))},isLoading:K})]})}function Q(){var e=(0,i.Z)();return(0,B.jsx)(o.Fragment,{children:(0,B.jsx)(l.Z,{bgcolor:e.palette.grey[0],p:3,sx:{marginLeft:{xs:"12px",sm:"24px",lg:"0px"},marginRight:{xs:"12px",sm:"24px",lg:"0px"},borderRadius:3,mt:"-10px",minHeight:"calc(99%)"},children:(0,B.jsx)($,{})})})}}}]);